[TOC]

## Shell简介

1. Shell是一个命令解释器，还是一个功能强大的编程语言，可以直接调用Linux系统命令
2. Bourne和C
   1. Bourne Shell主要包括 sh、ksh、Bash、psh、zsh
   2. C 主要包括csh、tcsh
3. Bash与sh兼容，现在使用的Linux就是使用Bash作为用户的基本Shell

## Shell的执行

1. echo 'hello world！'
2. echo [选项] [输出内容]
   1. -e 支持反斜线控制的字符转换
   2. 支持颜色输出
3. Shell的执行方式
   1. 程序可以输入绝对路径或相对路径执行
   2. 程序可以用bash 脚本名执行，这里不用赋予执行权限
4. dos2unix 文件名 快速从dos格式转化为unix文件格式

## Bash基本功能

1. history [选项] [历史命令保存文件]
   1. -c 清空历史命令
   2. -w 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history
2. 历史命令默认会保存1000条，可以在环境变量配置文件/etc/profile中进行修改
3. 上下箭头调用以前命令
4. !n 重复执行第n条命令
5. !! 重复执行上一条命令
6. !字符串 重复执行最后一条该字串开头的命令
7. Tab 自动补全

## 命令的别名与常用快捷键

1. alias 别名='原命令'
2. 命令的执行顺序
   1. 绝对路径或相对路径的命令
   2. 别名
   3. Bash的内部命令
   4. 按照$PATH环境变量定义的目录查找顺序找到的第一个命令
3. 让别名永久生效需要修改 /root/.bashrc
4. 常用快捷键Ctrl+
   1. a 把光标移动到命令行开头
   2. e 把光标移动到命令行结尾
   3. c 强制终止当前的命令
   4. l 清屏
   5. u 删除或剪切光标之前的命令
   6. k 删除或剪切光标之后的命令
   7. y 粘贴u、k剪切的命令
   8. r 在历史命令中搜索
   9. d 退出当前终端
   10. z 暂停
   11. s 暂停屏幕输出
   12. q 恢复屏幕输出

## 输入输出重定向

1. 标准输入输出 键盘、显示器
   1. 0 标准输入
   2. 1 标准输出
   3. 2 标准错误输出、
2. 输出重定向
   1. 标准重定向
      1. 命令 > 文件 覆盖方式
      2. 命令 >> 文件 追加方式
   2. 标准错误重定向
      1. 错误命令 2> 覆盖
      2. 错误命令 2>> 追加
   3. 正确和错误同时保存
      1. 命令 > 文件 2>&1 或者 命令 &>文件 覆盖
      2. 命令 >> 文件 2>&1 或者 命令 &>文件 覆盖
      3. 命令>>文件1 2>>文件2 分开保存
   4. /dev/null 是垃圾项，可以将部分命令的输出直接丢入该目录
3. 输入重定向
   1. wc [选项] [文件名] 统计命令
   2. -c 统计字节数
   3. -w 统计单词数
   4. -l 统计行数

## 多命令顺序执行与管道符

1. 多命令
   1. ; 顺序执行
   2. && 逻辑与
   3. || 逻辑或
   4. dd [选项] 命令 磁盘对拷命令
      1. if=输入文件 制定源文件或源设备
      2. of=输出文件 制定目标文件或目标设备
      3. bs=字节数 制定一次输入/输入多少字节，即把这些字节看作一个数据块
      4. count=个数 制定输入/输出多少个数据块
   5. /dev/zero 是0
2. 管道符 |
   1. 命令1 的正确输出作为 命令2的操作对象 例如 ll -a /etc | more    、    netstat -an | gerp "ESTABLISHED"
3. 通配符和其他特殊符号
   1. 通配符
      1. '?' 一个字符
      2. '*' 任意多个字符
      3. '[]' 任意一个字符
      4. '[-]' 匹配任意一个字符 -代表一个范围
      5. '[^]' 逻辑非，不匹配字符
   2. 特殊字符
      1. '' 单引号，其中的所有字符都没有特殊含义
      2. "" 双引号 特殊符号没有特殊含义
         1. $ 调用变量值
         2. ` 引用命令
         3. \ 转义字符
      3. `` 系统命令，Bash会先执行他
      4. $() 和反引号作用一样，建议使用此条
      5. #在Shell脚本中，#开头代表注释

## 用户自定义变量

1. 变量设置规则
   1. 变量名称可以由字母、数字、下划线组成，但不能以数字开头
   2. Bash中，变量的默认类型都是字符串，如果要进行数值运算，则必须制定变量类型
   3. 变量用=赋值，如果有空格则需要引起
   4. 变量值可以使用\
   5. 如果需要增加变量的值，可以进行变量值叠加，用"$变量名"或用${变量名}包含
   6. 也可以把命令的结果赋值
   7. 环境变量名建议大写
2. 变量分类
   1. 用户自定义变量
      1. echo $变量名 申明变量
      2. set 查询变量
      3. unset 变量名 删除变量
   2. 环境变量
      1. 变量操作
         1. 用户自定义变量在当前Shell中生效，而环境变量会在子Shell中也生效。如果把这个环境变量写入相应的配置文件，那么这个环境变量就会在所有的Shell中生效
         2. export 变量名=变量值 申明变量
         3. env 查询变量
         4. unset 变量名 删除变量
      2. PATH 变量是系统查找命令的路径，用:隔开
         1. 临时改变环境变量中的PATH PATH="$PATH":/root
      3. PS1 用户提示符
   3. 位置参数变量，脚本当中传递参数或数据，变量名不能自定义，作用固定
      1. $n n为数字，0代表命令本身，1~9代表第一到第九个参数，十个以上的参数需要用大括号包含
      2. $* 这个变量代表命令行中所有的参数，$*把所有的参数看成一个整体
      3. $@ 这个变量也代表命令行中所有的参数，不过把每个参数区分对待
      4. $# 这个变量代表命令行中所有参数的个数
   4. 预定义变量，是Bash中已经定义好的变量，变量名不能自定义，作用固定
      1. $? 最后一次执行的命令的返回状态，0为正确执行，非0为执行错误
      2. $$ 当前进程的进程号
      3. $! 后台运行的最后一个进程号
      4. & 代表后台执行，在进程后加&即为后台执行
   5. 接受键盘输入
      1. read [选项] [变量名]
         1. -p 提示信息 在等待read输入时输出提示信息
         2. -t 单位s read命令会一直等待用户输入，使用此选项可以指定等待时间
         3. -n 字符数 read命令只接受指定的字符数就会执行
         4. -s 隐藏输入的数据，适用于机密信息输入

## Bash的运算符

1. declare [+/-] [选项] 变量名 声明变量类型

   1. "-" 给变量设定类型属性
   2. "+" 取消变量的类型属性
   3. -i 将变量声明为整数型
   4. -x 将变量声明为环境变量
   5. -p 显示指定变量的被声明的类型

2. expr或let数值运算工具

   1. declare方式

      ```shell
      declare -i dd=$aa+$bb
      ```

   2. expr方式

      ```shell
      dd=$(expr $aa + $bb)
      ```

   3. let方式

      ```shell
      dd=$(($aa+$bb))
      ```

3. 其他运算符与C类似

## 变量测试与内容替换

1. 变量测试表

## 环境变量配置文件

1. 环境变量
2. source 命令 source配置文件 或 .配置文件 使环境变量生效
3. 系统默认环境变量有PATH、HISTSIZE、PS1、HOSTNAME等
4. 系统环境变量配置文件
   1. /etc/profile
      1. 定义一些系统变量USER LOGNAME MAIL PATH HOSTNAME HISTSIZE umask
      2. 调用/etc/profile.d/*.sh
   2. /etc/profile.d/*.sh
   3. ~/.bash_profile
   4. ~/.bashrc
   5. /etc/bashrc
5. etc下是对所有用户生效
6. 其他配置文件和登录信息
   1. ~/.bash_logout 注销时生效的环境变量配置文件
   2. ~/bash_history 历史命令
   3. /etc/issue 支持一些转义字符标记的变量 只对本地登录有效
   4. /etc/issue.net 该文件是纯文本
   5. 是否显示4的欢迎信息，由ssh的配置文件/etc/ssh/sshd_config决定，加入"Banner /etc/issue.net"行才能显示，要重启ssh服务
   6. 登录后欢迎信息 /etc/motd 本地远程登录皆生效


## Shell编程

1. 正则表达式
   1. 正则表达式用来匹配符合条件的字符串，是包含匹配，支持grep、awk、sed等命令
   2. 通配符用来匹配符合条件的文件名，是完全匹配，ls、find、cp这些命令不支持正则表达式
